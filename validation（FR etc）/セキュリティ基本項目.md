---
tags:
  - ＃セキュリティ
  - ＃認証
  - ＃HTTPS
  - ＃ハッシュ
  - ＃CSRF
  - ＃セッション再生成
  - ＃制限
---

# 認証周りセキュリティ 基本項目



> **優先度順**（★5が最高、★1が最低）

---

## ★★★★★ HTTPS（TLS通信）
- **概要**：通信内容の盗聴・改ざんを防止  
- **ポイント**：常時 HTTPS 化（Let’s Encrypt 等）、HSTS ヘッダー設定

---

## ★★★★☆ パスワードハッシュ化
- **概要**：平文保存禁止 → bcrypt, Argon2 などを利用  
- **ポイント**：コストパラメータ調整、ソルト自動生成

---

## ★★★★☆ CSRF（クロスサイトリクエストフォージェリ）
- **概要**：偽のリクエストによる不正操作を防止  
- **ポイント**：トークン生成＆検証、SameSite 属性活用

---

## ★★★☆☆ セッション再生成
- **概要**：ログイン時に session_id を更新 → セッションフィクセーション対策  
- **ポイント**：`session_regenerate_id()`、Laravel は `login` 時自動生成

---

## ★★★☆☆ セキュア＆HttpOnly クッキー
- **Secure**：HTTPS 通信時のみ送信  
- **HttpOnly**：JavaScript からアクセス不可 → XSS影響軽減

---

## ★★☆☆☆ レートリミット
- **概要**：認証試行回数を制限 → ブルートフォース防止  
- **ポイント**：IP or ユーザー単位、時間窓設定（例：1分間に5回まで）

---

## ★★☆☆☆ 認証失敗時のロックアウト／カウント制限
- **概要**：一定回数失敗で一時的にログイン不可  
- **ポイント**：Laravel の `throttle` ミドルウェア／Fortify の設定

---

## ★☆☆☆☆ 入力バリデーション＋出力エスケープ
- **入力バリデーション**：型・長さ・形式チェック  
- **出力エスケープ**：XSS防止（Blade の `{{ }}` 自動エスケープ など）

---

> ### Tips
> - **多層防御**：これらは組み合わせて使うこと  
> - **定期レビュー**：新たな脆弱性対応やライブラリ・フレームワークの更新を追う  
> - **ログ監視**：異常なアクセスをアラート化

