
---

```php
$errorKeys = is_array($row["name"])    //この行の入力が配列形式がチェックする 1参照
    ? array_map(fn ($name) => str_replace(["[", "]"], [".", ""], $name), $row["name"])  //2 参照
    : [str_replace(["[", "]"], [".", ""], $row["name"])];
```

### 1

たとえば行データ `$row` がこうなっているとします：
```
["label" => "出勤", "name" => "clock_in", "type" => "time"]
```
この場合　`$row["name"]` は文字列 `"clock_in"` なので `is_array($row["name"])` は配列ではない為 `false`

一方、休憩時間のように「2つの入力欄（開始と終了）」を持つ行では：
```php
[
  "label" => "休憩",
  "name" => ["breaks[0][break_in]", "breaks[0][break_out]"],
  "type" => "time-range"
]
```

`$row["name"]` は 配列 `is_array($row["name"])` は `true`

---
#### 2 

1.  単純な入力項目
```php
$row["name"] = "clock_in";


→ str_replace(["[", "]"], [".", ""], "clock_in")
→ "clock_in"（変化なし）
```

これはもともと配列じゃないので、
変換してもそのまま "clock_in"。
→ 結果：["clock_in"]（配列の中に1つだけ入れる）

2. ネストした配列入力項目
```php
$row["name"] = "breaks[0][break_in]";
→ str_replace(["[", "]"], [".", ""], "breaks[0][break_in]")
→ "breaks.0.break_in"（ここでドット記法に変換）
```
→ これは Laravel の バリデーションエラーキー として扱いやすい形。

---

#### 3. メリット

1. 単一項目でも複数項目でも同じ処理でエラー表示できる

休憩時間のように複数入力欄を持つ行（break_in, break_out）も、
出勤時刻のように1つしかない項目も、
どちらも $errorKeys に配列として統一しておけばこう書けます：
```php
@foreach ($errorKeys as $key)
    @error($key)
        <span class="error">{{ $message }}</span>
    @enderror
@endforeach
```
こうすることで「分岐不要で全部同じロジック」で済む。


2. バリデーションエラーキーが扱いやすくなる（＝FRの形式に合わせる）

Laravelのバリデーションエラーは
"breaks.0.break_in" のような ドット記法 で返されます。

でも Blade 側の name 属性は
breaks[0][break_in] のように ブラケット記法 です。

そのままだと対応しないので、
`str_replace(["[", "]"], [".", ""], $name)` でFR の形式に合わせています。
